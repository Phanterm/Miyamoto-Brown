{
	id: "miyamoto_playable",
	is_strict: true,
	is_human: true,
	hitpoints: 4,
	zorder: 1,
	editor_info: { category: "player" },
	
	
	properties:{
	
		last_punched: {
		type:"int",
		default: 0,
		},
		last_uppercut: {
		type:"int",
		default: 0,
		},
		punch_finished:"cycle - last_punched > 16",
		uppercut_finished:"cycle - last_uppercut > 24",
		crouch_jump: {type: "int", default: -600},
		standing_jump: -1000,
		
	},
	on_process:"[
		//------------------------------WALKING----------------------------------
		if(ctrl_right and is_standing and punch_finished and animation != 'crouch', [
			set(facing,1),
			if (animation != 'walk', set(animation, 'walk')), //'set animation' will set on every frame, so keep in mind when activating this on command
			set(velocity_x, 300)]), 
		if(ctrl_left and is_standing and punch_finished and animation != 'crouch',[
			set(facing,-1),
			if (animation != 'walk', set(animation, 'walk')), 
			set(velocity_x, -300)]), 
		if((not(ctrl_left or ctrl_right))and(is_standing)and(not animation in ['punch1','beginuppercut','uppercut','enduppercut']), //allows a list of excluded animations
			[set(animation, 'stand')]),
			
		//-------------------------------CROUCHING-------------------------------
		if ((ctrl_down and self.animation in ['stand','crouch','walk'] and self.animation not in ['punch1']), 
	[
			set(animation, 'crouch'),
			set(velocity_x, 0)]),	
		if ((ctrl_left and self.animation='crouch'),[ set(facing,-1)]),
		if ((ctrl_right and self.animation='crouch'),[ set(facing,1)]),
		//-------------------------------ATTACKING-------------------------------
		if(ctrl_tongue and animation != 'punch1' and is_standing and not animation in ['jump','fall','crouch','beginuppercut','uppercut','enduppercut'], 
			if(punch_finished,
				[set(animation, 'punch1'),
				spawn('miyamoto_playable.punch_proj',mid_x+5*facing,mid_y-11,{facing:facing,velocity_x:1500*facing}),
				set(velocity_x,0),
				set(last_punched, dump(cycle)), //make it so that the player must press the attack button instead of holding it to repeat punching
			])),

]",

	on_ctrl_tongue:"[
//-AERIAL ATTACKS ****************************************************************************************
		if(animation in ['prejump','jump','fall'] and velocity_x = 0,
			set(animation, 'jumping_kick')), //Jumping kick attack when there's no momentum
		if(animation in ['prejump','jump','fall'] and velocity_x != 0,
			set(animation,'flying_kick')), //Flying kick attack when there is momentum
//-GROUND ATTACKS ****************************************************************************************
		if(animation in ['crouch'],  
			if(uppercut_finished,
				[set(animation, 'beginuppercut'), set(last_punched, dump(cycle)), spawn('miyamoto_playable.uppercut_proj',mid_x+18*facing,mid_y-25,{facing:facing})],
				),
			),
		]",

//-------------------------------JUMPING---------------------------------			
on_ctrl_jump:"[if(is_standing and punch_finished, 
					[  //check the animation changing back to 'walk' or 'stand' on jumping at a ledge and continuing to jump without the proper animation. 
				
					if (animation != ['jump','prejump','fall'], set(animation, 'prejump')),
					set(velocity_y, crouch_jump), //work on Miyamoto falling straight down upon walking off of an edge.
					//add some x velocity to increase jump distance.
					if(self.animation in ['crouch'], 
					set(velocity_y,crouch_jump), 
				)])]",
on_leave_prejump_anim: "[if(ctrl_jump and not ctrl_down, [set(velocity_y,standing_jump)])]",
on_enter_prejump_anim:"debug('entering jump')",



//---------------------ON END ANIMATION ---------------------------------------
	//--ATTACK ANIMATIONS
	on_end_beginuppercut_anim:"set(animation, 'uppercut')",
	on_end_uppercut_anim:"set(animation, 'enduppercut')",
	on_end_enduppercut_anim:"set(animation, 'crouch')",

on_end_anim:"if(animation='punch1', if(is_standing, set(animation,'stand'),set(animation,'jump'), set(animation, 'prejump'), set(animation, 'crouch')),)",
//set(animation,animation))", //continues the animation
on_end_crouch_anim:"if(not(ctrl_down),set(animation,'stand'))",
on_end_jump_anim:"[debug('falling'), set(animation,'fall')]",
on_end_prejump_anim:"set(animation,'jump')",
on_collide_feet:"[set(animation,'stand'),set(velocity_x, 0)]",
	
	animation: [
		{
		"@base": true,
		image: "playable/miyamoto-sheet.png",
		accel_y: 40,
		solid_area: [20,32,10,5],
		pad: 3,
		},
		{
		id: "stand",
		rect: [1,1,32,33],
		frames:1,
		frames_per_row: 1,
		velocity_x: 0,
		},	
		{
		id: "walk",
		rect: [1,37,32,69],
		frames:4,
		frames_per_row: 4,
		duration: 12,
		},
		{
		id: "prejump",
		rect: [36,1,67,33],
		frames:1,
		frames_per_row: 1,
		duration: 5,
		},
		{
		id: "jump",
		rect: [71,1,102,33],
		frames:1,
		frames_per_row: 1,
		duration:80,
		//we need to probably set the hitboxes or area to be smaller, or move the animation down to the feet somehow.
		},
		{
		id: "fall",
		rect: [71,1,102,33],
		frames:1,
		frames_per_row: 1,
		velocity_x: 0,
		//we need to probably set the hitboxes or area to be smaller, or move the animation down to the feet somehow.
		},
		{
		id: "crouch",
		rect:[1,145,32,177],
		frames:1,
		frames_per_row: 1,
		},
		
		//ATTACK ANIMATIONS*********************************
		
		{
		id: "punch1",
		rect: [1,73,32,105],
		frames:2,
		frames_per_row: 2,
		duration: 4,
		},
		{
		id: "beginuppercut",
		rect: [1,325,32,362],
		solid_area: [20,37,10,5],
		frames:2,
		frames_per_row: 2,
		duration: 2,
		},
		{
		id: "uppercut",
		rect: [71,325,102,362],
		solid_area: [20,37,10,5],
		frames:1,
		frames_per_row: 1,
		duration: 15,
		},
		{
		id: "enduppercut",
		rect: [106,325,137,362],
		solid_area: [20,37,10,5],
		frames:1,
		frames_per_row: 1,
		duration: 5,
		},
		{
		id: "flying_kick",
    	rect: [176,1,207,33],
		frames:1,
		frames_per_row: 1,
		duration: 1,
		},
		{
		id: "jumping_kick",
    	rect: [106,1,137,33],
		frames:2,
		frames_per_row: 2,
		duration: 3,
		}
	],
	object_type: [
		{
		id:"punch_proj",
		on_create:"schedule(4,die())",
		on_collide_object:"die()", //if it hits something, get rid of the punch
		animation: [{
			id:"punch_proj_normal",
			image: "playable/miyamoto-sheet.png",
			rect: [1,109,10,118],
			area: "all",
			attack_area: "all", 
			damage: 1, //how much damage it does. Can change later. Maybe stronger punches can do more damage.
			}],
		},
		{
		id:"uppercut_proj",
		on_create:"schedule(10,die())",
		animation: [{
			id:"uppercut_proj_normal",
			image: "playable/miyamoto-sheet.png",
			rect: [211,325,220,362],
			frames: 5,
			frames_per_row:5,
			pad:3,
			duration: 2,
			area: "all",
			attack_area: "all", 
			damage: 1, //how much damage it does. Can change later. Maybe stronger punches can do more damage.
			}],
		}
		
	]
}